databaseChangeLog:
  - changeSet:
      id: 001
      author: mohamed
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
              - column:
                  name: username
                  type: VARCHAR(255)
              - column:
                  name: password
                  type: VARCHAR(255)
              - column:
                  name: email
                  type: VARCHAR(255)

        - createTable:
            tableName: customer
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
              - column:
                  name: address
                  type: VARCHAR(255)
              - column:
                  name: balance
                  type: FLOAT

        - addForeignKeyConstraint:
            baseTableName: customer
            baseColumnNames: id
            referencedTableName: users
            referencedColumnNames: id
            constraintName: fk_customer_user

        - createTable:
            tableName: admin
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true

        - addForeignKeyConstraint:
            baseTableName: admin
            baseColumnNames: id
            referencedTableName: users
            referencedColumnNames: id
            constraintName: fk_admin_user

        - createTable:
            tableName: book
            columns:
              - column: { name: id, type: BIGINT, autoIncrement: true, constraints: { primaryKey: true } }
              - column: { name: author, type: VARCHAR(255) }
              - column: { name: title, type: VARCHAR(255) }
              - column: { name: description, type: VARCHAR(255) }
              - column: { name: quantity, type: INT }
              - column: { name: price, type: FLOAT }

        - createTable:
            tableName: orders
            columns:
              - column: { name: id, type: BIGINT, autoIncrement: true, constraints: { primaryKey: true } }
              - column: { name: order_date, type: TIMESTAMP }
              - column: { name: customer_id, type: BIGINT }
              - column: { name: status, type: VARCHAR(50) }

        - addForeignKeyConstraint:
            baseTableName: orders
            baseColumnNames: customer_id
            referencedTableName: customer
            referencedColumnNames: id
            constraintName: fk_orders_customer

        - createTable:
            tableName: order_item
            columns:
              - column: { name: id, type: BIGINT, autoIncrement: true, constraints: { primaryKey: true } }
              - column: { name: order_id, type: BIGINT }
              - column: { name: book_id, type: BIGINT }
              - column: { name: quantity, type: INT }
              - column: { name: price, type: FLOAT }

        - addForeignKeyConstraint:
            baseTableName: order_item
            baseColumnNames: order_id
            referencedTableName: orders
            referencedColumnNames: id
            constraintName: fk_orderitem_order

        - addForeignKeyConstraint:
            baseTableName: order_item
            baseColumnNames: book_id
            referencedTableName: book
            referencedColumnNames: id
            constraintName: fk_orderitem_book

        - createTable:
            tableName: book_history
            columns:
              - column: { name: id, type: BIGINT, autoIncrement: true, constraints: { primaryKey: true } }
              - column: { name: entity_id, type: BIGINT }
              - column: { name: field, type: VARCHAR(255) }
              - column: { name: old_value, type: VARCHAR(255) }
              - column: { name: new_value, type: VARCHAR(255) }
              - column: { name: changed_by, type: BIGINT }
              - column: { name: timestamp, type: TIMESTAMP }
